<!DOCTYPE html>
<html lang="lt">
<head>
<meta charset="UTF-8">
<title>AsmeninÄ— statymÅ³ analizÄ—</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<style>
:root {--bg:#f2f2f2;--card:#fff;--text:#000}
.dark {--bg:#121212;--card:#1e1e1e;--text:#fff}
body{font-family:Arial;background:var(--bg);color:var(--text);padding:15px}
h1{text-align:center}
.card{background:var(--card);padding:15px;border-radius:10px;margin-bottom:15px}
input,select,button{width:100%;padding:10px;margin-bottom:8px}
button{background:#333;color:#fff;border:none;border-radius:6px}
table{width:100%;border-collapse:collapse;font-size:13px}
th,td{border:1px solid #666;padding:5px;text-align:center}
.delete{color:red;cursor:pointer}
small{opacity:.7}
</style>
</head>

<body>

<h1>ğŸ“Š StatymÅ³ analizÄ—</h1>
<button onclick="toggleDark()">ğŸŒ™ Dark mode</button>

<div class="card">
<form id="betForm">
<input id="event" placeholder="RungtynÄ—s" required>
<input id="sport" placeholder="Sportas / Lyga">
<input id="odds" type="number" step="0.01" placeholder="Koeficientas" required>
<input id="stake" type="number" placeholder="Statymas â‚¬" required>
<input id="prob" type="number" step="0.01" placeholder="Mano tikimybÄ— (0â€“1)" required>
<select id="result">
<option value="">Rezultatas</option>
<option value="win">Win</option>
<option value="loss">Loss</option>
</select>
<button type="submit">â• PridÄ—ti</button>
</form>
</div>

<div class="card">
<label>ğŸ” Filtrai</label>
<input id="filterSport" placeholder="Filtruoti pagal sportÄ…">
<select id="filterValue" onchange="render()">
<option value="all">Visi</option>
<option value="value">Tik value bet</option>
</select>
</div>

<div class="card">
<table>
<thead>
<tr>
<th>Event</th><th>Sportas</th><th>Odds</th><th>Stake</th>
<th>Value</th><th>Kelly â‚¬</th><th>P/L</th><th>âŒ</th>
</tr>
</thead>
<tbody id="bets"></tbody>
</table>
</div>

<div class="card" id="stats"></div>

<div class="card"><canvas id="chart"></canvas></div>

<div class="card">
<button onclick="exportCSV()">ğŸ“ Eksportuoti CSV</button>
<small>FailÄ… gali importuoti Ä¯ Excel / Sheets</small>
</div>

<script>
let bets=JSON.parse(localStorage.getItem("bets"))||[];
let dark=localStorage.getItem("dark")==="true";
if(dark)document.body.classList.add("dark");

function toggleDark(){
document.body.classList.toggle("dark");
localStorage.setItem("dark",document.body.classList.contains("dark"));
}

function valueBet(p,o){return (p*o-1)}
function profit(b){return b.result==="win"?b.stake*b.odds-b.stake:b.result==="loss"?-b.stake:0}
function kelly(p,o,bank=100){
let k=((p*(o-1)-(1-p))/(o-1));
return k>0?(k*bank).toFixed(2):0;
}

function render(){
const tbody=document.getElementById("bets");
const fs=document.getElementById("filterSport").value.toLowerCase();
const fv=document.getElementById("filterValue").value;
tbody.innerHTML="";
let totalStake=0,totalProfit=0,bank=0,curve=[];
bets.forEach((b,i)=>{
if(fs && !b.sport.toLowerCase().includes(fs))return;
let val=valueBet(b.prob,b.odds);
if(fv==="value" && val<=0)return;
totalStake+=b.stake;
totalProfit+=profit(b);
bank+=profit(b);
curve.push(bank);
tbody.innerHTML+=`
<tr>
<td>${b.event}</td>
<td>${b.sport}</td>
<td>${b.odds}</td>
<td>${b.stake}</td>
<td>${val.toFixed(2)}</td>
<td>${kelly(b.prob,b.odds)}</td>
<td>${profit(b).toFixed(2)}</td>
<td class="delete" onclick="del(${i})">âœ–</td>
</tr>`;
});
let roi=totalStake?((totalProfit/totalStake)*100).toFixed(2):0;
document.getElementById("stats").innerHTML=
`ğŸ’° Pelnas: <b>${totalProfit.toFixed(2)} â‚¬</b><br>
ğŸ“ˆ ROI: <b>${roi}%</b><br>
ğŸ“Š StatymÅ³: <b>${bets.length}</b>`;
draw(curve);
localStorage.setItem("bets",JSON.stringify(bets));
}

function del(i){bets.splice(i,1);render();}

document.getElementById("betForm").onsubmit=e=>{
e.preventDefault();
bets.push({
event:event.value,
sport:sport.value||"",
odds:+odds.value,
stake:+stake.value,
prob:+prob.value,
result:result.value
});
e.target.reset();render();
};

let chart;
function draw(data){
if(chart)chart.destroy();
chart=new Chart(document.getElementById("chart"),{
type:"line",
data:{labels:data.map((_,i)=>i+1),
datasets:[{label:"Bankroll",data:data,borderColor:"green"}]},
options:{plugins:{legend:{display:false}}}
});
}

function exportCSV(){
let csv="Event,Sport,Odds,Stake,Prob,Result\n";
bets.forEach(b=>{
csv+=`${b.event},${b.sport},${b.odds},${b.stake},${b.prob},${b.result}\n`;
});
let blob=new Blob([csv],{type:"text/csv"});
let a=document.createElement("a");
a.href=URL.createObjectURL(blob);
a.download="bets.csv";
a.click();
}

render();
</script>

</body>
</html>
