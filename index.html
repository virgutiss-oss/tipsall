<!DOCTYPE html>
<html lang="lt">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Krepšinio Prognozė LKL + ACB</title>
<style>
body { font-family: Arial, sans-serif; padding: 20px; background: #f2f2f2; }
h1 { text-align: center; }
label, select, button { display:block; margin:10px 0; width:100%; }
button { padding:10px; background:#0077cc; color:white; border:none; cursor:pointer; }
button:hover { background:#005fa3; }
#result { margin-top:20px; padding:10px; background:#fff; border:1px solid #ddd; }
</style>
</head>
<body>

<h1>Krepšinio Prognozė</h1>

<label>Lyga:</label>
<select id="league" onchange="populateTeams()">
  <option value="LKL">LKL</option>
  <option value="ACB">ACB</option>
</select>

<label>Komanda 1:</label>
<select id="team1"></select>

<label>Komanda 2:</label>
<select id="team2"></select>

<button onclick="calculate()">Apskaičiuoti prognozę</button>

<div id="result"></div>

<script>
// ------------------ Duomenys ------------------

// LKL komandos
const LKLTeams = ["Žalgiris Kaunas","Lietuvos Rytas","Neptūnas Klaipėda","Lietkabelis Panevėžys","Šiauliai","Juventus Utenos","Gargždai","Nevežis Kėdainiai","Jonava"];

// ACB komandos (pavyzdinės, realius duomenis reikia įdėti)
const ACBTeams = ["Real Madrid","Barcelona","Baskonia","Valencia","Bilbao","Joventut","Gran Canaria","Unicaja","Breogán","Manresa","Granada","Murcia","Andorra","Fuenlabrada","Burgos","Tenerife","Zaragoza","Girona"];

// Paskutinių 15 rungtynių pavyzdys
const last15Matches = {
  "Žalgiris Kaunas":[112,101,95,108,102,99,110,103,107,104,98,97,105,109,111],
  "Lietuvos Rytas":[81,85,88,92,89,86,90,87,84,91,83,85,88,86,89],
  "Neptūnas Klaipėda":[77,85,88,90,84,86,79,87,85,88,90,83,81,86],
  "Lietkabelis Panevėžys":[89,77,84,91,82,88,85,86,79,83,87,81,90,84,86],
  // ACB pavyzdžiai
  "Real Madrid":[105,100,98,102,99,101,97,104,100,101,103,99,105,98,100],
  "Barcelona":[103,105,100,107,102,106,104,103,101,108,99,102,104,105,100]
};

// H2H pavyzdys (tik keli, visus reikės įvesti tikrus)
const headToHead = {
  "Žalgiris Kaunas_Lietuvos Rytas":[
    {score1:90,score2:81},{score1:79,score2:75},{score1:76,score2:69},{score1:104,score2:98}
  ],
  "Real Madrid_Barcelona":[
    {score1:105,score2:100},{score1:102,score2:99},{score1:98,score2:97},{score1:101,score2:104}
  ]
};

// ------------------ Funkcijos ------------------

function populateTeams(){
  const league = document.getElementById('league').value;
  const teams = league=="LKL"?LKLTeams:ACBTeams;
  const sel1=document.getElementById('team1'), sel2=document.getElementById('team2');
  sel1.innerHTML=""; sel2.innerHTML="";
  teams.forEach(t=>{
    let opt1=document.createElement('option'); opt1.value=t; opt1.text=t; sel1.add(opt1);
    let opt2=document.createElement('option'); opt2.value=t; opt2.text=t; sel2.add(opt2);
  });
}

populateTeams(); // pradinė užpildymas

function avg(arr){ return arr.reduce((a,b)=>a+b,0)/arr.length; }

function calculate(){
  const t1=document.getElementById('team1').value;
  const t2=document.getElementById('team2').value;

  const last15_1=last15Matches[t1] || [];
  const last15_2=last15Matches[t2] || [];

  const last15Avg1=last15_1.length>0?avg(last15_1):0;
  const last15Avg2=last15_2.length>0?avg(last15_2):0;
  const last15WinProb=last15Avg1/(last15Avg1+last15Avg2);

  // H2H
  const h2hKey=headToHead[t1+"_"+t2] || headToHead[t2+"_"+t1];
  let h2hWinProb=0.5, h2hDiff=0, h2hAvg1=0, h2hAvg2=0;
  if(h2hKey){
    const scores1=h2hKey.map(x=>x.score1);
    const scores2=h2hKey.map(x=>x.score2);
    h2hAvg1=avg(scores1); h2hAvg2=avg(scores2);
    h2hWinProb=avg(scores1)/(avg(scores1)+avg(scores2));
    h2hDiff=h2hAvg1-h2hAvg2;
    if(headToHead[t2+"_"+t1]) h2hDiff*=-1;
  }

  const finalWinProb=0.5*last15WinProb+0.5*h2hWinProb;
  const finalLoseProb=1-finalWinProb;
  const predictedDiff=(0.5*(last15Avg1-last15Avg2)+0.5*h2hDiff).toFixed(1);
  const predictedAvg=((last15Avg1+last15Avg2)/2 + (h2hAvg1+h2hAvg2)/2).toFixed(1);

  const over=Math.min(0.95, Math.max(0.05, (last15Avg1+last15Avg2)/200));
  const under=(1-over);
  const winner = finalWinProb>0.5?t1:t2;

  document.getElementById('result').innerHTML=`
    <h2>Prognozė:</h2>
    <p><strong>Win %:</strong> ${(finalWinProb*100).toFixed(1)}%</p>
    <p><strong>Lose %:</strong> ${(finalLoseProb*100).toFixed(1)}%</p>
    <p><strong>Prognozuojamas taškų skirtumas:</strong> ${predictedDiff}</p>
    <p><strong>Prognozuojamas taškų vidurkis:</strong> ${predictedAvg}</p>
    <p><strong>Over %:</strong> ${(over*100).toFixed(1)}%</p>
    <p><strong>Under %:</strong> ${(under*100).toFixed(1)}%</p>
    <p><strong>Prognozuojama laiminti komanda:</strong> ${winner}</p>
  `;
}

</script>
</body>
</html>
