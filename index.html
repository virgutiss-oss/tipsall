<!DOCTYPE html>
<html lang="lt">
<head>
<meta charset="UTF-8">
<title>AsmeninÄ— statymÅ³ analizÄ—</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<style>
:root {--bg:#f2f2f2;--card:#fff;--text:#000}
.dark {--bg:#121212;--card:#1e1e1e;--text:#fff}
body{font-family:Arial;background:var(--bg);color:var(--text);padding:15px}
h1{text-align:center}
.card{background:var(--card);padding:15px;border-radius:10px;margin-bottom:15px}
input,select,button{width:100%;padding:10px;margin-bottom:8px}
button{background:#333;color:#fff;border:none;border-radius:6px}
table{width:100%;border-collapse:collapse;font-size:13px}
th,td{border:1px solid #666;padding:5px;text-align:center}
.delete{color:red;cursor:pointer}
small{opacity:.7}
</style>
</head>

<body>

<h1>ğŸ€ AsmeninÄ— statymÅ³ analizÄ—</h1>
<button onclick="toggleDark()">ğŸŒ™ Dark mode</button>

<div class="card">
<form id="betForm">

<select id="league" onchange="loadTeams()" required>
<option value="">Pasirink lygÄ…</option>
</select>

<select id="team" required>
<option value="">Pasirink komandÄ…</option>
</select>

<input id="event" placeholder="RungtynÄ—s (nebÅ«tina)">
<input id="odds" type="number" step="0.01" placeholder="Koeficientas" required>
<input id="stake" type="number" placeholder="Statymas â‚¬" required>
<input id="prob" type="number" step="0.01" placeholder="Mano tikimybÄ— (0â€“1)" required>

<select id="result">
<option value="">Rezultatas</option>
<option value="win">Win</option>
<option value="loss">Loss</option>
</select>

<button type="submit">â• PridÄ—ti statymÄ…</button>
</form>
</div>

<div class="card">
<label>ğŸ” Filtrai</label>
<input id="filterLeague" placeholder="Filtruoti pagal lygÄ…">
<select id="filterValue" onchange="render()">
<option value="all">Visi</option>
<option value="value">Tik value bet</option>
</select>
</div>

<div class="card">
<table>
<thead>
<tr>
<th>Lyga</th><th>Komanda</th><th>Odds</th><th>Stake</th>
<th>Value</th><th>Kelly â‚¬</th><th>P/L</th><th>âŒ</th>
</tr>
</thead>
<tbody id="bets"></tbody>
</table>
</div>

<div class="card" id="stats"></div>
<div class="card"><canvas id="chart"></canvas></div>

<div class="card">
<button onclick="exportCSV()">ğŸ“ Eksportuoti CSV</button>
<small>Gali importuoti Ä¯ Excel / Google Sheets</small>
</div>

<script>
const leagues = {
"LKL (Lietuva)":["Å½algiris","Rytas","Wolves","Lietkabelis","NeptÅ«nas","Juventus","Å iauliai","NevÄ—Å¾is","Pieno Å¾vaigÅ¾dÄ—s","DzÅ«kija"],
"ACB (Ispanija)":["Real Madrid","Barcelona","Baskonia","Valencia","Unicaja","Joventut","Gran Canaria","Murcia","Zaragoza","Manresa","BreogÃ¡n","Obradoiro","Andorra","Girona","Granada"],
"BSL (Turkija)":["FenerbahÃ§e","Anadolu Efes","Galatasaray","BeÅŸiktaÅŸ","TofaÅŸ","TÃ¼rk Telekom","DarÃ¼ÅŸÅŸafaka","Bursaspor","BahÃ§eÅŸehir","PÄ±nar KarÅŸÄ±yaka","Manisa","Petkim"],
"BBL (Vokietija)":["Alba Berlin","Bayern Munich","Ulm","Bonn","Oldenburg","Ludwigsburg","Hamburg","Braunschweig","Chemnitz","Bamberg","WÃ¼rzburg","Vechta"],
"LNB Pro A (PrancÅ«zija)":["Monaco","ASVEL","Paris","Bourg","Dijon","Cholet","Nanterre","Le Mans","Limoges","Strasbourg","Roanne","Nancy"],
"NBA":["Atlanta Hawks","Boston Celtics","Brooklyn Nets","Charlotte Hornets","Chicago Bulls","Cleveland Cavaliers","Dallas Mavericks","Denver Nuggets","Detroit Pistons","Golden State Warriors","Houston Rockets","Indiana Pacers","LA Clippers","LA Lakers","Memphis Grizzlies","Miami Heat","Milwaukee Bucks","Minnesota Timberwolves","New Orleans Pelicans","New York Knicks","Oklahoma City Thunder","Orlando Magic","Philadelphia 76ers","Phoenix Suns","Portland Trail Blazers","Sacramento Kings","San Antonio Spurs","Toronto Raptors","Utah Jazz","Washington Wizards"]
};

let bets=JSON.parse(localStorage.getItem("bets"))||[];
let dark=localStorage.getItem("dark")==="true";
if(dark)document.body.classList.add("dark");

function toggleDark(){
document.body.classList.toggle("dark");
localStorage.setItem("dark",document.body.classList.contains("dark"));
}

function loadTeams(){
team.innerHTML="<option value=''>Pasirink komandÄ…</option>";
leagues[league.value]?.forEach(t=>{
let o=document.createElement("option");
o.value=t;o.textContent=t;team.appendChild(o);
});
}

Object.keys(leagues).forEach(l=>{
let o=document.createElement("option");
o.value=l;o.textContent=l;league.appendChild(o);
});

function valueBet(p,o){return p*o-1}
function profit(b){return b.result==="win"?b.stake*b.odds-b.stake:b.result==="loss"?-b.stake:0}
function kelly(p,o,bank=100){
let k=(p*(o-1)-(1-p))/(o-1);
return k>0?(k*bank).toFixed(2):0;
}

let chart;
function render(){
betsTable.innerHTML="";
let fs=filterLeague.value.toLowerCase();
let fv=filterValue.value;
let ts=0,tp=0,b=0,curve=[];
bets.forEach((x,i)=>{
if(fs&&!x.league.toLowerCase().includes(fs))return;
let v=valueBet(x.prob,x.odds);
if(fv==="value"&&v<=0)return;
ts+=x.stake;tp+=profit(x);b+=profit(x);curve.push(b);
betsTable.innerHTML+=`
<tr>
<td>${x.league}</td><td>${x.team}</td><td>${x.odds}</td><td>${x.stake}</td>
<td>${v.toFixed(2)}</td><td>${kelly(x.prob,x.odds)}</td><td>${profit(x).toFixed(2)}</td>
<td class="delete" onclick="del(${i})">âœ–</td>
</tr>`;
});
stats.innerHTML=`ğŸ’° Pelnas: <b>${tp.toFixed(2)} â‚¬</b><br>ğŸ“ˆ ROI: <b>${ts?((tp/ts)*100).toFixed(2):0}%</b>`;
if(chart)chart.destroy();
chart=new Chart(chartEl,{type:"line",data:{labels:curve.map((_,i)=>i+1),datasets:[{data:curve,borderColor:"green"}]},options:{plugins:{legend:{display:false}}}});
localStorage.setItem("bets",JSON.stringify(bets));
}

function del(i){bets.splice(i,1);render();}

betForm.onsubmit=e=>{
e.preventDefault();
bets.push({
league:league.value,
team:team.value,
event:event.value,
odds:+odds.value,
stake:+stake.value,
prob:+prob.value,
result:result.value
});
betForm.reset();render();
};

function exportCSV(){
let csv="League,Team,Odds,Stake,Prob,Result\n";
bets.forEach(b=>csv+=`${b.league},${b.team},${b.odds},${b.stake},${b.prob},${b.result}\n`);
let a=document.createElement("a");
a.href=URL.createObjectURL(new Blob([csv],{type:"text/csv"}));
a.download="bets.csv";a.click();
}

const betsTable=document.getElementById("bets");
const stats=document.getElementById("stats");
const chartEl=document.getElementById("chart");

render();
</script>

</body>
</html>
